<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Redirecting to App...</title>
    <script>
      document.addEventListener('DOMContentLoaded', function () {
        // IMPORTANT: Replace 'exfit-ai' with your actual Expo app scheme.
        // This is defined in your Expo app's app.json under the 'scheme' key.
        // Example: "scheme": "myawesomescanapp" would mean APP_SCHEME = 'myawesomescanapp';
        const APP_SCHEME = 'exfit-ai';

        // Get the full path from the URL, including the query parameters.
        // Example: If URL is https://yourdomain.com/scan/abc?item=123&color=red
        // window.location.pathname will be "/scan/abc"
        // window.location.search will be "?item=123&color=red"
        // currentPath will be "/scan/abc?item=123&color=red"
        const currentPath = window.location.pathname + window.location.search;

        // Construct the deep link URL using the app scheme.
        // When the app opens, it will receive the full 'appDeepLink' string.
        // Expo's Linking module in your app can then parse this URL to get the path and parameters.
        const appDeepLink = `${APP_SCHEME}://scan`; // Include the full path and query params

        // Set your App Store link here (replace with your actual app ID, e.g., 'id1234567890')
        // You can find your app ID in App Store Connect or the App Store URL itself.
        const APP_STORE_URL =
          'https://apps.apple.com/us/app/your-app-name/idYOUR_APP_ID';

        function openAppOrRedirectToStore() {
          // Attempt to open the app using the custom scheme.
          // This will trigger the app if installed.
          window.location.href = appDeepLink;

          // Set a timeout to redirect to the App Store if the app doesn't open.
          // This timeout should be long enough to allow the app redirect attempt to complete.
          // A common duration is 2-3 seconds.
          // setTimeout(() => {
          //   // Check if the app is still in the browser. If so, redirect to the App Store.
          //   // This is a heuristic and might not be perfect, but it's a common approach.
          //   if (document.visibilityState === 'visible') {
          //     window.location.replace(APP_STORE_URL);
          //   }
          // }, 2500); // 2.5 seconds timeout
        }

        // Attempt to open the app immediately when the page loads.
        openAppOrRedirectToStore();
      });
    </script>
  </head>
  <body></body>
</html>
